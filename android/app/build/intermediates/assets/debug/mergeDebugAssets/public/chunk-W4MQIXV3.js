import{a as f,b as y,c as g}from"./chunk-62KKBQKF.js";import{d as h}from"./chunk-2R7TGF7V.js";import{h as c}from"./chunk-LNJ3S2LQ.js";var p=function(o){return o.Prompt="PROMPT",o.Camera="CAMERA",o.Photos="PHOTOS",o}(p||{}),d=function(o){return o.Rear="REAR",o.Front="FRONT",o}(d||{}),w=function(o){return o.Uri="uri",o.Base64="base64",o.DataUrl="dataUrl",o}(w||{});var u=class extends g{getPhoto(a){return c(this,null,function*(){return new Promise((i,t)=>c(this,null,function*(){if(a.webUseInput||a.source===p.Photos)this.fileInputExperience(a,i,t);else if(a.source===p.Prompt){let e=document.querySelector("pwa-action-sheet");e||(e=document.createElement("pwa-action-sheet"),document.body.appendChild(e)),e.header=a.promptLabelHeader||"Photo",e.cancelable=!1,e.options=[{title:a.promptLabelPhoto||"From Photos"},{title:a.promptLabelPicture||"Take Picture"}],e.addEventListener("onSelection",r=>c(this,null,function*(){r.detail===0?this.fileInputExperience(a,i,t):this.cameraExperience(a,i,t)}))}else this.cameraExperience(a,i,t)}))})}pickImages(a){return c(this,null,function*(){return new Promise((i,t)=>c(this,null,function*(){this.multipleFileInputExperience(i,t)}))})}cameraExperience(a,i,t){return c(this,null,function*(){if(customElements.get("pwa-camera-modal")){let e=document.createElement("pwa-camera-modal");e.facingMode=a.direction===d.Front?"user":"environment",document.body.appendChild(e);try{yield e.componentOnReady(),e.addEventListener("onPhoto",r=>c(this,null,function*(){let n=r.detail;n===null?t(new f("User cancelled photos app")):n instanceof Error?t(n):i(yield this._getCameraPhoto(n,a)),e.dismiss(),document.body.removeChild(e)})),e.present()}catch{this.fileInputExperience(a,i,t)}}else console.error("Unable to load PWA Element 'pwa-camera-modal'. See the docs: https://capacitorjs.com/docs/web/pwa-elements."),this.fileInputExperience(a,i,t)})}fileInputExperience(a,i,t){let e=document.querySelector("#_capacitor-camera-input"),r=()=>{var n;(n=e.parentNode)===null||n===void 0||n.removeChild(e)};e||(e=document.createElement("input"),e.id="_capacitor-camera-input",e.type="file",e.hidden=!0,document.body.appendChild(e),e.addEventListener("change",n=>{let s=e.files[0],l="jpeg";if(s.type==="image/png"?l="png":s.type==="image/gif"&&(l="gif"),a.resultType==="dataUrl"||a.resultType==="base64"){let m=new FileReader;m.addEventListener("load",()=>{if(a.resultType==="dataUrl")i({dataUrl:m.result,format:l});else if(a.resultType==="base64"){let b=m.result.split(",")[1];i({base64String:b,format:l})}r()}),m.readAsDataURL(s)}else i({webPath:URL.createObjectURL(s),format:l}),r()}),e.addEventListener("cancel",n=>{t(new f("User cancelled photos app")),r()})),e.accept="image/*",e.capture=!0,a.source===p.Photos||a.source===p.Prompt?e.removeAttribute("capture"):a.direction===d.Front?e.capture="user":a.direction===d.Rear&&(e.capture="environment"),e.click()}multipleFileInputExperience(a,i){let t=document.querySelector("#_capacitor-camera-input-multiple"),e=()=>{var r;(r=t.parentNode)===null||r===void 0||r.removeChild(t)};t||(t=document.createElement("input"),t.id="_capacitor-camera-input-multiple",t.type="file",t.hidden=!0,t.multiple=!0,document.body.appendChild(t),t.addEventListener("change",r=>{let n=[];for(let s=0;s<t.files.length;s++){let l=t.files[s],m="jpeg";l.type==="image/png"?m="png":l.type==="image/gif"&&(m="gif"),n.push({webPath:URL.createObjectURL(l),format:m})}a({photos:n}),e()}),t.addEventListener("cancel",r=>{i(new f("User cancelled photos app")),e()})),t.accept="image/*",t.click()}_getCameraPhoto(a,i){return new Promise((t,e)=>{let r=new FileReader,n=a.type.split("/")[1];i.resultType==="uri"?t({webPath:URL.createObjectURL(a),format:n,saved:!1}):(r.readAsDataURL(a),r.onloadend=()=>{let s=r.result;i.resultType==="dataUrl"?t({dataUrl:s,format:n,saved:!1}):t({base64String:s.split(",")[1],format:n,saved:!1})},r.onerror=s=>{e(s)})})}checkPermissions(){return c(this,null,function*(){if(typeof navigator>"u"||!navigator.permissions)throw this.unavailable("Permissions API not available in this browser");try{return{camera:(yield window.navigator.permissions.query({name:"camera"})).state,photos:"granted"}}catch{throw this.unavailable("Camera permissions are not available in this browser")}})}requestPermissions(){return c(this,null,function*(){throw this.unimplemented("Not implemented on web.")})}pickLimitedLibraryPhotos(){return c(this,null,function*(){throw this.unavailable("Not implemented on web.")})}getLimitedLibraryPhotos(){return c(this,null,function*(){throw this.unavailable("Not implemented on web.")})}},x=new u;var R=y("Camera",{web:()=>new u});var S=(()=>{let a=class a{constructor(){}extractFaceDescriptor(t){return c(this,null,function*(){try{yield this.delay(1e3);let e=new Float32Array(128);for(let r=0;r<128;r++)e[r]=Math.random();return e}catch(e){return console.error("Erro ao extrair descritor facial:",e),null}})}compareFaces(t,e){return c(this,null,function*(){yield this.delay(500);let r=0;for(let n=0;n<Math.min(t.length,e.length);n++)r+=Math.abs(t[n]-e[n]);return r/Math.min(t.length,e.length)})}isMatch(t,e=.5){return t<e}saveFaceDescriptor(t,e){let r=Array.from(e);localStorage.setItem(`face_descriptor_${t}`,JSON.stringify(r))}getFaceDescriptor(t){let e=localStorage.getItem(`face_descriptor_${t}`);if(e){let r=JSON.parse(e);return new Float32Array(r)}return null}delay(t){return new Promise(e=>setTimeout(e,t))}};a.\u0275fac=function(e){return new(e||a)},a.\u0275prov=h({token:a,factory:a.\u0275fac,providedIn:"root"});let o=a;return o})();export{p as a,w as b,R as c,S as d};
